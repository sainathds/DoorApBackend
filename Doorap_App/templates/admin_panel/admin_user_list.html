
<style>	
	div.dataTables_wrapper div.dataTables_length label {
		margin-top: 15px!important;
		margin-left: 15px!important;
	}
	
	.validation{
		color:red;font-size:12px;
	}
	
	.form-group{
		margin-bottom: 0px !important;
	}
</style>
<!-- Content Wrapper. Contains page content -->
  <!-- <div class="content-wrapper"> -->
    <!-- Content Header (Page header) -->
    <div class="content-header">
      <div class="container-fluid">
        <div class="row mb-2">
          <div class="col-sm-6">
            <h1 class="m-0">Admin Users</h1>
          </div><!-- /.col -->
          <div class="col-sm-6">
            <ol class="breadcrumb float-sm-right">
              <li class="breadcrumb-item"><a href="#" onclick="Get_Dashboard_Data()">Home</a></li>
              <li class="breadcrumb-item active">Admin Users</li>
            </ol>
          </div>
        </div>
      </div>
    </div>
	
	<section class="content" style="margin-left: 15px;">
      <div class="container-fluid">
        
		<hr>
		
			 <div class="row" style="background-color:white;">
            <div class="col-md-3">
								<div class="form-group">
									<label >First Name <span class="validation">*</span></label>
									<!-- <div class="input-group bootstrap-touchspin bootstrap-touchspin-injected"> -->
									<input class="form-control" type="text" id="first_name" value="" maxlength="50"> 
									<center><span class="validation" id ="error_first_name" style="display:none;">Please Enter First Name</span></center>
								</div>
            </div>
						
						 <div class="col-md-3">
								<div class="form-group">
									<label >Last Name <span class="validation">*</span></label>
									<!-- <div class="input-group bootstrap-touchspin bootstrap-touchspin-injected"> -->
									<input class="form-control" type="text" id="last_name" value="" maxlength="50"> 
									<center><span class="validation" id ="error_last_name" style="display:none;">Please Enter Last Name</span></center>
								</div>
            </div>
						
						<div class="col-md-3">
								<div class="form-group">
									<label >Email <span class="validation">*</span></label>
									<!-- <div class="input-group bootstrap-touchspin bootstrap-touchspin-injected"> -->
									<input class="form-control" type="text" id="email" value="" maxlength="50"> 
									<center><span class="validation" id ="error_email" style="display:none;">Please Enter Email</span></center>
									<center><span class="validation" id ="error_email_already" style="display:none;">Email Already Exists</span></center>
								</div>
            </div>
						
						<div class="col-md-3">
								<div class="form-group">
									<label >Mobile No. <span class="validation"></span></label>
									<!-- <div class="input-group bootstrap-touchspin bootstrap-touchspin-injected"> -->
									<input class="form-control" type="text" id="mobile_no" value="" maxlength="10"> 
									<!-- <center><span class="validation" id ="error_email" style="display:none;">Please Enter Email</span></center> -->
								</div>
            </div>
						<div class="col-md-3">
								<div class="form-group">
									<label >User Type <span class="validation">*</span></label>
									<select class="form-control" id="user_type">
										<option value="Admin" selected>Admin</option>
										<option value="Executive">Executive</option>
									</select>
								</div>
            </div>
						
						<div class="col-md-3">
								<div class="form-group">
									<label >Password <span class="validation">*</span></label>
									<!-- <div class="input-group bootstrap-touchspin bootstrap-touchspin-injected"> -->
									<input class="form-control" type="text" id="password" value="" maxlength="50"> 
									<center><span class="validation" id ="error_password" style="display:none;">Please Enter Password</span></center>
								</div>
            </div>
						
						<div class="col-md-3">
								<div class="form-group">
									<label >Confirm Password <span class="validation">*</span></label>
									<!-- <div class="input-group bootstrap-touchspin bootstrap-touchspin-injected"> -->
									<input class="form-control" type="password" id="confirm_password" value="" maxlength="50"> 
									<center><span class="validation" id ="error_confirm_password" style="display:none;">Password Not Matched..!</span></center>
								</div>
            </div>
						
						<div class="col-md-2">
								<div class="form-group">
									<label ></label>
									<button type="button" class="btn btn-primary" style="width:90px;margin-top: 32px;margin-bottom: 15px;" onclick="Add_Admin_User()">Add User</button>
								</div>
            </div>
					
						
         </div> 
				
				<hr>
		
        <div class="row" style="background-color:white;">
			<div class="table">
				<table id="datatable" class="table table-striped datatable">
					 <thead>
					<tr>
					  <th scope="col">#</th>
					  <th scope="col">Name</th>
					  <th scope="col">Email</th>
					  <th scope="col">Mobile No.</th>
					  <th scope="col">Password</th>
					  <th scope="col">User Type</th>
					  <th scope="col">Action</th>
					</tr>
				  </thead>
				  <tbody>
					{% for l in admin_user_list %}
					<tr>
					  <th scope="row">{{forloop.counter}}</th>
					  <td>{% if l.first_name %}{{ l.first_name }}{% else %}{% endif %} {% if l.last_name %}{{ l.last_name }}{% else %}{% endif %}</td>
					  <td>{% if l.email %}{{ l.email }}{% else %}-{% endif %}</td>
					  <td>{% if l.mobile_no %}{{ l.mobile_no }}{% else %}-{% endif %}</td>
					  <td>{% if l.password %}{{ l.password }}{% else %}-{% endif %}</td>
					  <td>{% if l.user_type %}{{ l.user_type }}{% else %}-{% endif %}</td>
					  <td>
							{% if l.main_user %}
							
							{% else %}
							<button type="button" class="btn btn-primary" style="width:40px;padding: 1px;" onclick="Del('{{l.id}}')">
							<i class="far fa-trash-alt"></i>
							</button>
							{% endif %}
						</td>
					</tr>
					{% endfor %}
				  </tbody>
				</table>
			</div>
        </div>
      </div>
    </section>
	
	<!-- </div> -->
	<!-- <script src="https://code.jquery.com/jquery-3.6.0.slim.min.js" integrity="sha256-u7e5khyithlIdTpu22PHhENmPcRdFiHRjhAuHcs05RI=" crossorigin="anonymous"></script> -->
	<!-- <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script> -->
	
<script>
$(document).ready(function(){
	$('#datatable').DataTable({
		<!-- "bFilter": false  -->
		});
	<!-- $('.customer').css("color", "White"); -->
});


function Del(id){
	<!-- $('#delete_hidden').val(id) -->
	<!-- $('#delModal').modal('show'); -->
	swal({
		title: "Are you sure?",
		text: "To Delete this Entry!",
		icon: "warning",
		<!-- buttons: true, -->
		buttons: ["No", "Yes"],
		closeOnClickOutside: false,
		dangerMode: true,
		})
		.then((willDelete) => {
			if (willDelete) {
				<!-- alert(id) -->
				<!-- id = $('#canclebookingid').val(); -->
				<!-- status = "Cancelled"; -->
				$.ajax({
					method : "POST",
					url : "/delete_admin_user/",
					data : {
						'user_id':id,
					},
					success : function(response){
						if (response == "deleted"){
							swal("Entry has been Deleted..!", {
								icon: "success",
								button: "Ok",
								closeOnClickOutside: false,
								}).then(function() {
									<!-- location.reload(); -->
									Get_Admin_User_List();
								});
				
						}
						else{
							swal("Minimum one Admin account is required, You cannot delete this entry", {
								icon: "warning",
								button: "Ok",
								closeOnClickOutside: false,
								}).then(function() {
									<!-- location.reload(); -->
									Get_Admin_User_List();
								});
						}
					}
				})
			}
			<!-- else { -->
				<!-- swal("Entry not Deleted !"); -->
			<!-- } -->
	});
}


$('#first_name').keyup(function(){
	$('#error_first_name').hide()
})
$('#last_name').keyup(function(){
	$('#error_last_name').hide()
})
$('#email').keyup(function(){
	$('#error_email').hide()
})
$('#email').keyup(function(){
	$('#error_email_already').hide()
})
$('#password').keyup(function(){
	$('#error_password').hide()
})
$('#confirm_password').keyup(function(){
	$('#error_confirm_password').hide()
})


function Add_Admin_User(){
	var first_name = $('#first_name').val();
	var last_name = $('#last_name').val();
	var email = $('#email').val();
	var mobile_no = $('#mobile_no').val();
	var user_type = $('#user_type').val();
	var password = $('#password').val();
	var confirm_password = $('#confirm_password').val();
	
	if(first_name == ""){
		$('#error_first_name').show()
	}
	else if(last_name == ""){
		$('#error_last_name').show()
	}
	else if(email == ""){
		$('#error_email').show()
	}
	else if(password == ""){
		$('#error_password').show()
	}
	else if(password != confirm_password){
		$('#error_confirm_password').show()
	}
	else{
		$.ajax({
				method : "POST",
				url : "/add_new_admin_user/",
				data : {
					'first_name':first_name,
					'last_name':last_name,
					'email':email,
					'mobile_no':mobile_no,
					'user_type':user_type,
					'password':password,
				},
				success : function(response){
					$('#loading').hide();
					if (response == "success"){
						swal("User Added Successfully", {
							icon: "success",
							button: "Ok",
							closeOnClickOutside: false,
							}).then(function() {
								Get_Admin_User_List();
							});
			
					}
					else if(response == "exists"){
						$('#error_email_already').show();
					}
					else{
						swal("Something Went Wrong");
					}
				}
			})
	}

}



</script>
